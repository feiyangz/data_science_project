---
title: "data_science_project"
output: html_document
---

```{r}
library(rvest)
library(stringr)
library(dplyr)
library(ggplot2)
library(data.table)
#find the website of data scientist positions in the united states from the indeed website
query = "data scientist"
l="United States"
session <- html_session("http://www.indeed.com")
form <- html_form(session)[[1]]
form <- set_values(form, q = query, l=l)

session1 <- submit_form(session, form)

url <- "https://www.indeed.com/q-data-scientist-jobs.html"
page <-read_html(url) 

#company <-webpage%>%html_nodes(".company")%>%html_text()
#skill <-webpage%>%html_nodes(".experienceList")%>%html_text()
#location <- webpage%>%html_nodes(".location")%>%html_text()
#webpage_table<- data.frame(company,skill,location)


#For jobs at all levels

company <- lapply(paste0("https://www.indeed.com/jobs?q=data+scientist1&start=", c(10,20,30)),
                function(url){
                    url %>% read_html() %>% 
                        html_nodes(".company") %>% 
                        html_text()
 })

company1=unlist(company, recursive = FALSE)

skill <- lapply(paste0("https://www.indeed.com/jobs?q=data+scientist1&start=", c(10,20,30,40,50)),
                function(url){
                    url %>% read_html() %>% 
                        html_nodes(xpath='//*[contains(concat( " ", @class, " " ), concat( " ", "experienceList", " " ))]') %>% 
                        html_text()
 })

skill1=unlist(skill, recursive = FALSE)

location <- lapply(paste0("https://www.indeed.com/jobs?q=data+scientist1&start=", c("",paste0("~",c(seq(10,100,by=10))))),
                function(url){
                    url %>% read_html() %>% 
                        html_nodes(".location") %>% 
                        html_text()
 })
location1=unlist(location, recursive = FALSE)
data=data.frame(company1,skill1,location1)


```

```{r}
pages = paste0("data-science-jobs",c("",paste0("~",2:30)))
https://www.indeed.com/q-data-scientist-jobs.html
https://www.indeed.com/jobs?q=data+scientist1&start=10


```










```{r}
# Submit the form on indeed.com for a job description and location using html_form() and set_values()
query = "data scientist"
l="United States"
session <- html_session("http://www.indeed.com")
form <- html_form(session)[[1]]
form <- set_values(form, q = query, l=l)


session1 <- submit_form(session, form)



salary_links <- html_nodes(session1, css = "#resultsCol li:nth-child(2) a") %>% html_attr("href")
salary_links <- paste(session$url, salary_links, sep='')
salaries <- lapply(salary_links, . %>% html() %>% html_nodes("#salary_display_table .salary") %>% html_text())
salary <- unlist(salaries)

# Store web url
data_sci_indeed <- session1

# Get job titles
job_title <- data_sci_indeed %>% 
  html_nodes("[itemprop=title]") %>%
  html_text()

# Get companies
company <- data_sci_indeed %>%
  html_nodes("[itemprop=hiringOrganization]") %>%
  html_text()

# Get locations
location <- data_sci_indeed %>%
  html_nodes("[itemprop=addressLocality]") %>%
  html_text()

# Get descriptions
description <- data_sci_indeed %>% html_nodes(xpath='//*[contains(concat( " ", @class, " " ), concat( " ", "experienceList", " " ))]') %>% html_text()

indeed_jobs <- data.frame(job_title,company,location,description,salary)

library(knitr)
kable(indeed_jobs, format = "html")
```


